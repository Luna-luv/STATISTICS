# 통계학 7주차 정규과제

📌통계학 정규과제는 매주 정해진 분량의 『*데이터 분석가가 반드시 알아야 할 모든 것*』 을 읽고 학습하는 것입니다. 이번 주는 아래의 **Statistics_7th_TIL**에 나열된 분량을 읽고 `학습 목표`에 맞게 공부하시면 됩니다.

아래의 문제를 풀어보며 학습 내용을 점검하세요. 문제를 해결하는 과정에서 개념을 스스로 정리하고, 필요한 경우 추가자료와 교재를 다시 참고하여 보완하는 것이 좋습니다.

7주차는 `3부. 데이터 분석하기`를 읽고 새롭게 배운 내용을 정리해주시면 됩니다.


## Statistics_7th_TIL

### 3부. 데이터 분석하기
### 13.머신러닝 분석 방법론
### 14.모델 평가



## Study Schedule

|주차 | 공부 범위     | 완료 여부 |
|----|----------------|----------|
|1주차| 1부 p.2~56     | ✅      |
|2주차| 1부 p.57~79    | ✅      | 
|3주차| 2부 p.82~120   | ✅      | 
|4주차| 2부 p.121~202  | ✅      | 
|5주차| 2부 p.203~254  | ✅      | 
|6주차| 3부 p.300~356  | ✅      | 
|7주차| 3부 p.357~615  | ✅      | 

<!-- 여기까진 그대로 둬 주세요-->

# 13.머신러닝 분석 방법론

```
✅ 학습 목표 :
* 선형 회귀와 다항 회귀를 비교하고, 데이터를 활용하여 적절한 회귀 모델을 구축할 수 있다. 
* 로지스틱 회귀 분석의 개념과 오즈(Odds)의 의미를 설명하고, 분류 문제에 적용할 수 있다.
* k-means 알고리즘의 원리를 설명하고, 적절한 군집 개수를 결정하여 데이터를 군집화할 수 있다.
```

## 13.1. 선형 회귀분석과 Elastic Net(예측모델)

### 선형 회귀 분석

선형 회귀는 하나 또는 여러 독립변수와 종속변수의 선형적 관계를 찾는 방법

```text
y = β₀ + β₁x₁ + β₂x₂ + ... + βₙxₙ + ε

β₀: 절편(intercept)
β₁, β₂, ..., βₙ: 기울기(coefficients)
ε: 오차항
```

### 다항 회귀 분석

독립변수와 종속변수의 관계가 비선형적일 때 다항식을 통해 데이터를 모델링

```text
y = β₀ + β₁x + β₂x² + β₃x³ + ... + βₙxⁿ + ε
```

**실무에서의 예시:**

* 마케팅 분야에서 광고비와 매출 간 관계가 직선적이지 않고 광고비 증가율이 높을수록 매출 증가 폭이 감소할 때 다항 회귀를 사용하여 모델링

| 비교 요소  | 선형 회귀    | 다항 회귀     |
| ------ | -------- | --------- |
| 적합성    | 단순 선형 관계 | 곡선 형태 데이터 |
| 계산 복잡성 | 낮음       | 높음        |
| 과적합 위험 | 낮음       | 높음        |

### Elastic Net

Elastic Net은 Ridge와 Lasso의 장점을 결합한 모델

* Ridge: 다중공선성 감소
* Lasso: 변수 선택

**실무에서의 예시:**

* 금융권에서 다수의 경제 지표 중 투자 수익률에 가장 큰 영향을 미치는 변수를 선별할 때 Elastic Net을 활용하여 모델을 구축하고 주요 변수를 선택함


## 13.2. 로지스틱 회귀분석 (분류모델)

### 개념

* 로지스틱 회귀는 이진 분류 문제에서 주로 사용, 주어진 데이터가 특정 범주에 속할 확률을 예측하는 통계 모델
* ex. 고객이 상품을 구매할지 여부, 환자가 특정 질병에 걸릴 가능성 예측

### 오즈(Odds)

* 사건이 발생할 확률(p)을 사건이 발생하지 않을 확률(1-p)로 나눈 값(사건의 발생 가능성)
* ex. 주사위를 던져 6이 나올 확률이 1/6이면 오즈는 1/5 (즉, 1/6 ÷ 5/6)

### 오즈비(Odds Ratio)

* 두 집단 간 특정 사건의 발생 가능성을 상대적으로 비교할 때 사용
* ex. 흡연자의 폐암 발생 오즈를 비흡연자의 폐암 발생 오즈로 나눈 값 = 오즈비 => 흡연자가 비흡연자에 비해 폐암에 걸릴 확률이 얼마나 높은가 

### 로지스틱 함수 (Sigmoid Function)

로지스틱 회귀는 선형 조합을 로짓(Logit) 변환을 통해 0과 1 사이의 확률값으로 변환

```text
로짓(Logit): 로그오즈(log-odds), 즉 log(p / (1 - p))
```

### 로지스틱 회귀 분석의 활용

* **이탈 예측(Churn prediction)**: 통신사에서 고객이 서비스를 해지할 가능성을 예측하여 사전 대응책을 마련
* **질병 진단(질병 여부 판정)**: 의료 분야에서 환자의 임상 데이터를 바탕으로 질병 발생 확률을 계산하여 예방적 조치를 시행
* **마케팅 캠페인의 효과성 평가**: 특정 광고 또는 프로모션이 소비자의 구매 결정에 미치는 영향을 확률적으로 평가하여 전략을 최적화

---

## 13.8. k-means 클러스터링(군집모델)

### 목적 

* **군집 내 거리 최소화**: 같은 군집 내의 데이터들이 서로 가깝도록 구성
* **군집 간 거리 최대화**: 서로 다른 군집의 중심은 최대한 멀리 떨어지도록 구성

```text
기본 전제: 각 군집은 중심(centroid)을 기준으로 모여 있으며,
유클리드 거리(또는 다른 거리 척도)를 사용하여 중심과의 거리를 최소화한다.
```

### 최적의 군집 개수 결정 방법

1. **Elbow Method (엘보우 기법)**
   * x축: 군집 개수 k / y축: SSE(총 제곱 오차합)
   * k를 늘릴수록 SSE는 감소하지만, 어느 시점 이후부터 감소폭이 급격히 줄어듦
   * 그 지점을 '팔꿈치(elbow)'로 보고 최적의 k로 판단

2. **Silhouette Score (실루엣 계수)**
   * 개별 데이터가 자기 군집 내 얼마나 잘 속해 있는지와 다른 군집과는 얼마나 잘 분리돼 있는지를 동시에 측정
   * 값의 범위는 -1 ~ 1 (1에 가까울수록 더 잘 군집화됨)

---

# 14. 모델 평가

```
✅ 학습 목표 :
* 유의확률(p-value)을 해석할 때 주의할 점을 설명할 수 있다.
* 분석가가 올바른 주관적 판단을 위한 필수 요소를 식별할 수 있다.
```

## 14.3. 회귀성능 평가지표

| 지표                                         | 의미              | 사용 시 주의점                   |
| ------------------------------------------ | --------------- | -------------------------- |
| R-Square, Adjusted R-Square                | 설명력, 모델의 적합성    | 변수 개수가 많을수록 R-Square 증가 가능 |
| RMSE (Root Mean Square Error)              | 예측 오차의 제곱근      | 큰 오차에 민감함                  |
| MAE (Mean Absolute Error)                  | 예측 오차의 절댓값 평균   | 이상치에 덜 민감                  |
| MAPE (Mean Absolute Percentage Error)      | 오차의 백분율 평균      | 0 근처 값에서 오류 증가             |
| RMSLE (Root Mean Square Logarithmic Error) | 로그 변환 후 RMSE    | 큰 값에서의 편향 감소               |
| AIC와 BIC                                   | 모델의 복잡성과 적합성 평가 | 값이 작을수록 좋은 모델              |


## 14.6. 유의확률의 함정

* **유의확률(p-value)**는 귀무가설(null hypothesis)이 참일 때, 현재 관찰된 결과 이상으로 극단적인 결과가 나올 확률
* **주의점**: p-value는 단순히 “우연에 의해 이런 결과가 나올 확률이 낮다”는 것을 의미

### 유의사항

* **낮은 p-value ≠ 효과 크기**
  * p-value가 0.01이라고 해서 연구의 효과가 크다 x
  * 표본의 크기가 매우 크면 실제로는 미미한 차이(실질적으로 중요하지 않은 차이)도 p-value가 낮게 나올 수 있음음
  * 반대로 표본이 적으면 실제로 큰 효과도 p-value가 높아질 수 있음

* **유의성(statistical significance) vs 실제 중요성(practical/clinical significance)**
  * p-value가 0.05 미만이라고 해서 반드시 현업 또는 사회적으로 의미 있는 결과라고 볼 수 없다!
  * 연구자가 해석할 때, 통계적 유의성과 실제 문제에 미치는 영향(실효성, 정책효과, 비용-편익 등)을 반드시 구분해야 함 

* **유의수준(α) 사전 설정**
  * 유의확률 해석 시 유의수준(예: 0.05)을 실험·분석 전 미리 정해 두어야 하며, 분석 후 임의로 조정해서는 안 됨!
  * 유의수준은 귀무가설이 실제로 참임에도 불구하고 기각할 확률(제1종 오류)을 의미 
  * 유의수준 설정 없이 분석 후 p-value에 따라 유리한 해석을 하는 것은 과학적 신뢰도를 떨어뜨릴 수 있다

## 14.7. 분석가의 주관적 판단과 스토리텔링

### 분석가의 주관적 판단이 중요한 이유

* **현업 지식의 활용**
  * 데이터만 보는 것이 아니라, 실제 비즈니스/사회 현장과 연결되는 지식을 바탕으로 해석
  * ex. 매출 데이터 분석 시, 특정 프로모션이나 이벤트 등 현장에서만 알 수 있는 맥락을 반영

* **모델 선택과 평가에서의 비판적 사고**
  * 단순히 성능이 좋은 모델만을 추구하는 것이 아니라, 데이터의 특성, 해석 가능성, 실무적 활용 가능성 등을 종합적으로 고려
  * 여러 모델 중 왜 이 모델이 적합한지, 결과가 신뢰할 수 있는지 스스로 판단해야 함

* **현실적인 맥락에 맞는 인사이트 제시**
  * 분석 결과를 단순히 나열하는 것이 아니라, 조직의 목표나 문제 해결에 실질적으로 기여할 수 있는 결론 도출
  * 결과가 비즈니스 의사결정, 정책 수립 등과 어떻게 연결되는지 명확히 제시

### 스토리텔링의 필요성과 전략

* **설득력 있는 스토리 전달**
  * 데이터를 이야기로 엮어내어, 청중이 쉽게 이해하고 공감할 수 있도록 전달
  * 데이터, 그래프, 숫자에만 의존하지 않고, 사례와 맥락을 설명하여 결과에 생명력을 부여

* **결과의 맥락과 해석 연결**
  * 왜 이 분석을 했고, 결과가 무엇을 의미하는지, 다음에 어떤 행동을 해야 하는지 구체적으로 전달
  * 결과가 실제 현장이나 정책에 미치는 영향까지 서술

* **직관적이고 명료한 표현**
  * 복잡한 분석 결과도 비전문가가 이해할 수 있도록 쉽게 설명
  * 불필요한 용어나 복잡한 수식보다, 핵심 메시지를 간결하게 전달


<br>
<br>

# 확인 문제

## **문제 1. 선형 회귀**

> **🧚 칼 피어슨의 아버지와 아들의 키 연구 결과를 바탕으로, 다음 선형 회귀식을 해석하세요.**  
> 칼 피어슨(Karl Pearson)은 아버지(X)와 아들(Y)의 키를 조사한 결과를 바탕으로 아래와 같은 선형 회귀식을 도출하였습니다. 아래의 선형 회귀식을 보고 기울기의 의미를 설명하세요. 
>  
> **ŷ = 33.73 + 0.516X**  
>   
> - **X**: 아버지의 키 (cm)  
> - **ŷ**: 아들의 예상 키 (cm)  

```
아버지의 키가 1cm 커질 때마다, 아들의 예상 키가 평균적으로 0.516cm 증가한다(아버지의 키가 1cm 증가할 때 아들의 예상 키 증가분)
```
---

## **문제 2. 로지스틱 회귀**  

> **🧚 다트비에서는 학생의 학업 성취도를 예측하기 위해 다항 로지스틱 회귀 분석을 수행하였습니다. 학업 성취도(Y)는 ‘낮음’, ‘보통’, ‘높음’ 3가지 범주로 구분되며, 독립 변수는 주당 공부 시간(Study Hours)과 출석률(Attendance Rate)입니다. 단, 기준범주는 '낮음' 입니다.**   

| 변수 | Odds Ratio Estimates | 95% Wald Confidence Limits |  
|------|----------------------|--------------------------|  
| Study Hours | **2.34** | (1.89, 2.88) |  
| Attendance Rate | **3.87** | (2.92, 5.13) |  

> 🔍 Q1. Odds Ratio Estimates(오즈비, OR)의 의미를 해석하세요.

<!--변수 Study Hours의 오즈비 값이 2.34라는 것과 Attendance Rate의 오즈비 값이 3.87이라는 것이 각각 무엇을 의미하는지 구체적으로 생각해보세요.-->

```
주당 공부 시간이 1단위 증가할 때, 학업 성취도가 기준 범주에서 보통 또는 높음으로 분류될 오즈가 2.34배 증가
출석률이 1단위 증가할 때, 학업 성취도가 기준 범주에서 보통 또는 높음으로 분류될 오즈가 3.87배 증가
```

> 🔍 Q2. 95% Wald Confidence Limits의 의미를 설명하세요.
<!--각 변수의 신뢰구간에 제시된 수치가 의미하는 바를 생각해보세요.-->

```
Study Hours의 실제 오즈비는 1.89와 2.88 사이에 있을 가능성이 95%이다.
Attendance Rate의 실제 오즈비는 2.92와 5.13 사이에 있을 가능성이 95%이다.

```

> 🔍 Q3. 이 분석을 기반으로 학업 성취도를 향상시키기 위한 전략을 제안하세요.
<!--Study Hours와 Attendance Rate 중 어느 변수가 학업 성취도에 더 큰 영향을 미치는지를 고려하여, 학업 성취도를 향상시키기 위한 효과적인 전략을 구체적으로 제시해보세요.-->

```
출석률의 오즈비가 주당 공부시간보다 높음
-> 출석률 향상을 우선순위에 두고 동시에 공부 시간 증가를 병행
```

---


## **문제 3. k-means 클러스터링**

> **🧚 선교는 고객을 유사한 그룹으로 분류하기 위해 k-means 클러스터링을 적용했습니다. 초기에는 3개의 군집으로 설정했지만, 결과가 만족스럽지 않았습니다. 선교가 최적의 군집 수를 찾기 위해 사용할 수 있는 방법을 한 가지 이상 제시하고 설명하세요.**

```
Elbow Method
각 k별로 군집화 결과의 SSE을 계산해 그래프로 그리기
-> k가 증가할수록 SSE는 감소하지만, 어느 순간부터 감소폭이 급격히 줄어듦
=> 이 그래프에서 SSE 감소가 완만해지는 지점이 최적의 군집 수로 간주
```

### 🎉 수고하셨습니다.